BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
fusilegpd.full <- lmer(LegPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
stargazer(odifus,eq5dfus,backfus,legfus, type='html',ci=TRUE, covariate.labels=c("PT within 3 months","Depression Score","Age","Male","Preop Narcotic Use","Smoker","Insurance: Medicare/Private/VA","NeurogenicClaudication","Revision","Number Levels (3+4)","ASA Grade (3+4)","BMI","Baseline Back Pain","Baseline Leg Pain","Baseline ODI","Baseline EQ5D"), dep.var.labels=c("ODI Percentage <br> Beta (95% CI) </br>", "EQ-5D <br> Beta (95% CI) </br>", "Back Pain <br> Beta (95% CI) </br>", "Leg Pain <br> Beta (95% CI) </br>"), digits=2, initial.zero=FALSE, model.numbers=FALSE, omit="Constant", single.row=TRUE, notes.align="l", dep.var.caption="Fusion")
mytable <- table((Gender,PT_3mo), data=ptdatawide) # A will be rows, B will be columns
mytable <- table((Gender,PT_3mo) data=ptdatawide) # A will be rows, B will be columns
mytable <- table(Gender,PT_3mo) # A will be rows, B will be columns
attach(ptdatawide)
mytable <- table(Gender,PT_3mo) # A will be rows, B will be columns
mytable <- table(Gender,PTOT_3m) # A will be rows, B will be columns
mytable # print table
margin.table(mytable, 1) # A frequencies (summed over B)
margin.table(mytable, 2) # B frequencies (summed over A)
prop.table(mytable) # cell percentages
prop.table(mytable, 1) # row percentages
install.packages("gmodels")
library(gmodels)
CrossTable(ptdatawide$Gender, ptdatawide$PTOT_3m)
CrossTable(ptdatawide$Gender, ptdatawide$PTOT_3m, prop.c=TRUE, prop.r=FALSE, prop.t=FALSE, chisq=TRUE, format="SPSS")
CrossTable(ptdatawide$Gender, ptdatawide$PTOT_3m, prop.c=TRUE, prop.r=FALSE, prop.t=FALSE, chisq=TRUE, format="SPSS",prop.chisq=FALSE)
CrossTable(ptdatawide$Gender, ptdatawide$PTOT_3m, prop.c=TRUE, prop.r=FALSE, prop.t=FALSE, chisq=TRUE, format="SPSS",prop.chisq=FALSE, dnn=c("No PT","PT"))
library("Hmisc", lib.loc="~/R/win-library/3.3")
install.packages("htmlTable")
library("Hmisc", lib.loc="~/R/win-library/3.3")
library("plotly", lib.loc="~/R/win-library/3.3")
library("rms", lib.loc="~/R/win-library/3.3")
library("htmlTable", lib.loc="~/R/win-library/3.3")
plot(s, groups='PTOT_3m')
# plot(s, groups='treat', outerlabels=FALSE) for standard lattice output
plot(s, groups='PTOT_3m', key=list(columns=2, space='bottom'))
plot(summaryP(Smoker + Gender ~ PTOT_3m, data=ptdatawide, exclude1=FALSE), col='green')
plot(s, groups='PTOT_3m')
plot(s, groups='treat', outerlabels=FALSE) for standard lattice output
#plot(s, groups='PTOT_3m', key=list(columns=2, space='bottom'))
plot(summaryP(Smoker + Gender ~ PTOT_3m, data=ptdatawide, exclude1=FALSE), col='green')
plot(s, groups='PTOT_3m')
plot(s, groups='treat', outerlabels=FALSE) #for standard lattice output
#plot(s, groups='PTOT_3m', key=list(columns=2, space='bottom'))
plot(summaryP(Smoker + Gender ~ PTOT_3m, data=ptdatawide, exclude1=FALSE), col='green')
n <- 100
f <- function(na=FALSE) {
x <- sample(c('N', 'Y'), n, TRUE)
if(na) x[runif(100) < .1] <- NA
x
}
set.seed(1)
d <- data.frame(x1=f(), x2=f(), x3=f(), x4=f(), x5=f(), x6=f(), x7=f(TRUE),
age=rnorm(n, 50, 10),
race=sample(c('Asian', 'Black/AA', 'White'), n, TRUE),
sex=sample(c('Female', 'Male'), n, TRUE),
treat=sample(c('A', 'B'), n, TRUE),
region=sample(c('North America','Europe'), n, TRUE))
d <- upData(d, labels=c(x1='MI', x2='Stroke', x3='AKI', x4='Migraines',
x5='Pregnant', x6='Other event', x7='MD withdrawal',
race='Race', sex='Sex'))
dasna <- subset(d, region=='North America')
with(dasna, table(race, treat))
png('/tmp/summaryP.png', width=550, height=550)
s <- summaryP(race + sex + yn(x1, x2, x3, x4, x5, x6, x7, label='Exclusions') ~
region, data=d)
# add exclude1=FALSE above to include female category
plot(s, val ~ freq | region * var, groups='treat')  # best looking
# The above uses the latticeExtra package's useOuterStrips function to improve output
# Default output without using latticeExtra: plot(s, groups='treat', outerlabels=FALSE)
dev.off()
View(ptdatawide)
View(ptdatawide)
s <- summaryM(Smoker + Gender ~ PTOT_3m, data=ptdatawide,
overall=FALSE, test=TRUE)
# If not using captions, just use plot(s, which='categorical')
putHfig(plot(s, which='categorical'),
'Proportions and', mu$chisq(), 'tests for categorical variables')
putHfig <- function(x, ..., scap=NULL, extra=NULL, subsub=TRUE, hr=TRUE,
table=FALSE, file='', append=FALSE) {
table=FALSE, file='', append=FALSE,
expcoll=NULL) {
ec <- length(expcoll) > 0
if(ec && ! table)
stop('expcoll can only be specified for tables, not figures')
putHfig <- function(x, ..., scap=NULL, extra=NULL, subsub=TRUE, hr=TRUE,
table=FALSE, file='', append=FALSE,
expcoll=NULL) {
ec <- length(expcoll) > 0
if(ec && ! table)
stop('expcoll can only be specified for tables, not figures')
s <- summaryM(Smoker + Gender ~ PTOT_3m, data=ptdatawide,
overall=FALSE, test=TRUE)
# If not using captions, just use plot(s, which='categorical')
putHfig(plot(s, which='categorical'),
'Proportions and', mu$chisq(), 'tests for categorical variables')
library("knitr", lib.loc="~/R/win-library/3.3")
]
}
detach("package:knitr", unload=TRUE)
library("knitr", lib.loc="~/R/win-library/3.3")
install.packages("Hmisc")
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
install.packages(c("acepack", "arm", "BH", "colorspace", "curl", "data.table", "ggplot2", "hms", "htmlwidgets", "knitr", "mnormt", "openssl", "plotly", "qgraph", "Rcpp", "reshape2", "rmarkdown", "rms", "scales", "SparseM", "stringi", "texreg", "XML", "yaml"))
library("lme4", lib.loc="~/R/win-library/3.3")
detach("package:lme4", unload=TRUE)
library("Hmisc", lib.loc="~/R/win-library/3.3")
install.packages("Rcpp")
?html
??html
??prmsd
??npct
??html
??mu
mu$installcsl(rec=TRUE)   # get list of recommended styles
mu$installcsl()     # web search of styles meeting your criteria
# Install a .csl file to your project directory:
mu$installcsl('american-medical-association')
mu$installcsl(rec=TRUE)   # get list of recommended styles
mu$installcsl('american-medical-association')
??markupSpecs
load("Z:/Pennings/PT Study/PTworking_cache/html/summaryM_b2b33f10efb489c61c189de8740d843b.RData")
library(readr)
ptdatawide <- read_csv("Z:/Pennings/PT Study/RFiles/ptdatawide.csv")
View(ptdatawide)
??histboxp
install.packages("webshot")
require(readr)
require(Hmisc)
require(rms)
require(stargazer)
require(lme4)
require(plotly)
knitrSet(lang='markdown', h=5)
# knitrSet redirects all messages to messages.txt
options(grType='plotly') # for certain graphics functions
mu <- markupSpecs$html   # markupSpecs is in Hmisc
cap  <- mu$cap           # function to output html caption
lcap <- mu$lcap          # for continuation for long caption
# These last 2 functions are used by the putHfig function in Hmisc
ptdatawide <- read_csv("Z:/Pennings/PT Study/RFiles/ptdatawide.csv")
fusiondata <- subset(ptdatawide, Surgery=='Fusion')
lamidata <- subset(ptdatawide, Surgery=='Laminectomy')
ptlongnumptdummy <- read_csv("Z:/Pennings/PT Study/RFiles/ptlongnumptdummy.csv")
longdummyfusiondata <- subset(ptlongnumptdummy,Surgery=='Decompression and fusion')
longdummylamidata <- subset(ptlongnumptdummy,Surgery=='Decompression alone')
odifus <- ols (ODIPercentage_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + ODIPercentage_bsln,data=fusiondata)
eq5dfus <- ols (EQ5Dscore_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln,data=fusiondata)
backfus <- ols (BackPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=fusiondata)
legfus <- ols (LegPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=fusiondata)
odilam <- ols (ODIPercentage_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + ODIPercentage_bsln,data=lamidata)
eq5dlam <- ols (EQ5Dscore_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln,data=lamidata)
backlam <- ols (BackPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=lamidata)
leglam <- ols (LegPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=lamidata)
lamiodipd.full <- lmer(ODIPercentage ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + ODIPercentage_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
lamieq5dpd.full <- lmer(EQ5Dscore ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
lamibackpd.full <- lmer(BackPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
lamilegpd.full <- lmer(LegPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
fusiodipd.full <- lmer(ODIPercentage ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + ODIPercentage_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
fusieq5dpd.full <- lmer(EQ5Dscore ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
fusibackpd.full <- lmer(BackPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
fusilegpd.full <- lmer(LegPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
s <- summaryM(Gender + Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication + Revision + NumberLevels_2grps + ASAGrade_2grps + Surgery + Depscore + Age + BMI + BackPain_bsln + LegPain_bsln + ODIPercentage_bsln + EQ5Dscore_bsln ~ PT_3m, data=ptdatawide,
overall=FALSE, test=TRUE)
plot(s, which='categorical', height=5)
require(readr)
require(Hmisc)
require(rms)
require(stargazer)
require(lme4)
require(plotly)
knitrSet(lang='markdown', h=5)
# knitrSet redirects all messages to messages.txt
options(grType='plotly') # for certain graphics functions
mu <- markupSpecs$html   # markupSpecs is in Hmisc
cap  <- mu$cap           # function to output html caption
lcap <- mu$lcap          # for continuation for long caption
# These last 2 functions are used by the putHfig function in Hmisc
ptdatawide <- read_csv("Z:/Pennings/PT Study/RFiles/ptdatawide.csv")
fusiondata <- subset(ptdatawide, Surgery=='Fusion')
lamidata <- subset(ptdatawide, Surgery=='Laminectomy')
ptlongnumptdummy <- read_csv("Z:/Pennings/PT Study/RFiles/ptlongnumptdummy.csv")
longdummyfusiondata <- subset(ptlongnumptdummy,Surgery=='Decompression and fusion')
longdummylamidata <- subset(ptlongnumptdummy,Surgery=='Decompression alone')
odifus <- ols (ODIPercentage_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + ODIPercentage_bsln,data=fusiondata)
eq5dfus <- ols (EQ5Dscore_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln,data=fusiondata)
backfus <- ols (BackPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=fusiondata)
legfus <- ols (LegPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=fusiondata)
odilam <- ols (ODIPercentage_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + ODIPercentage_bsln,data=lamidata)
eq5dlam <- ols (EQ5Dscore_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln,data=lamidata)
backlam <- ols (BackPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=lamidata)
leglam <- ols (LegPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=lamidata)
lamiodipd.full <- lmer(ODIPercentage ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + ODIPercentage_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
lamieq5dpd.full <- lmer(EQ5Dscore ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
lamibackpd.full <- lmer(BackPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
lamilegpd.full <- lmer(LegPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
fusiodipd.full <- lmer(ODIPercentage ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + ODIPercentage_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
fusieq5dpd.full <- lmer(EQ5Dscore ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
fusibackpd.full <- lmer(BackPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
fusilegpd.full <- lmer(LegPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
s <- summaryM(Gender + Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication + Revision + NumberLevels_2grps + ASAGrade_2grps + Surgery + Depscore + Age + BMI + BackPain_bsln + LegPain_bsln + ODIPercentage_bsln + EQ5Dscore_bsln ~ PT_3m, data=ptdatawide,
overall=FALSE, test=TRUE)
plot(s, which='categorical', height=5)
plot(s, which='continuous', vars=1 : 4)
plot(s, which='continuous', vars=5 : 7)
html(s, caption='Baseline characteristics by PT within 3 months',
exclude1=FALSE, npct='both', digits=2,
prmsd=TRUE, brmsd=FALSE, msdsize=mu$smaller, long=TRUE)
stargazer(odifus,eq5dfus,backfus,legfus, type='html',ci=TRUE, covariate.labels=c("PT within 3 months","Depression Score","Age","Male","Preop Narcotic Use","Smoker","Insurance: Medicare/Private/VA","Neurogenic Claudication","Revision","Number Levels (3+4)","ASA Grade (3+4)","BMI","Baseline Back Pain","Baseline Leg Pain","Baseline ODI","Baseline EQ5D"), dep.var.labels=c("ODI Percentage <br> Beta (95% CI) </br>", "EQ-5D <br> Beta (95% CI) </br>", "Back Pain <br> Beta (95% CI) </br>", "Leg Pain <br> Beta (95% CI) </br>"), digits=2, initial.zero=FALSE, model.numbers=FALSE, omit="Constant", single.row=TRUE, notes.align="l", dep.var.caption="Fusion")
stargazer(odifus,eq5dfus,backfus,legfus, type='html',ci=TRUE, covariate.labels=c("PT within 3 months","Depression Score","Age","Male","Preop Narcotic Use","Smoker","Insurance: Medicare/Private/VA","Neurogenic Claudication","Revision","Number Levels (3+4)","ASA Grade (3+4)","BMI","Baseline Back Pain","Baseline Leg Pain","Baseline ODI","Baseline EQ5D"), dep.var.labels=c("ODI Percentage <br> Beta (95% CI) </br>", "EQ-5D <br> Beta (95% CI) </br>", "Back Pain <br> Beta (95% CI) </br>", "Leg Pain <br> Beta (95% CI) </br>"), digits=2, initial.zero=FALSE, model.numbers=FALSE, omit="Constant", single.row=TRUE, notes.align="l", dep.var.caption="Fusion")
require(readr)
require(Hmisc)
require(rms)
require(stargazer)
require(lme4)
require(plotly)
knitrSet(lang='markdown', h=5)
# knitrSet redirects all messages to messages.txt
options(grType='plotly') # for certain graphics functions
mu <- markupSpecs$html   # markupSpecs is in Hmisc
cap  <- mu$cap           # function to output html caption
lcap <- mu$lcap          # for continuation for long caption
# These last 2 functions are used by the putHfig function in Hmisc
ptdatawide <- read_csv("Z:/Pennings/PT Study/RFiles/ptdatawide.csv")
fusiondata <- subset(ptdatawide, Surgery=='Fusion')
lamidata <- subset(ptdatawide, Surgery=='Laminectomy')
ptlongnumptdummy <- read_csv("Z:/Pennings/PT Study/RFiles/ptlongnumptdummy.csv")
longdummyfusiondata <- subset(ptlongnumptdummy,Surgery=='Decompression and fusion')
longdummylamidata <- subset(ptlongnumptdummy,Surgery=='Decompression alone')
odifus <- ols (ODIPercentage_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + ODIPercentage_bsln,data=fusiondata)
eq5dfus <- ols (EQ5Dscore_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln,data=fusiondata)
backfus <- ols (BackPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=fusiondata)
legfus <- ols (LegPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=fusiondata)
odilam <- ols (ODIPercentage_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + ODIPercentage_bsln,data=lamidata)
eq5dlam <- ols (EQ5Dscore_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln,data=lamidata)
backlam <- ols (BackPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=lamidata)
leglam <- ols (LegPain_3m ~ PT_3m + Depscore + Age + Gender +
Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication +
Revision + NumberLevels_2grps + ASAGrade_2grps + BMI +
BackPain_bsln + LegPain_bsln,data=lamidata)
lamiodipd.full <- lmer(ODIPercentage ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + ODIPercentage_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
lamieq5dpd.full <- lmer(EQ5Dscore ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
lamibackpd.full <- lmer(BackPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
lamilegpd.full <- lmer(LegPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummylamidata, REML=FALSE)
fusiodipd.full <- lmer(ODIPercentage ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + ODIPercentage_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
fusieq5dpd.full <- lmer(EQ5Dscore ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln + EQ5Dscore_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
fusibackpd.full <- lmer(BackPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
fusilegpd.full <- lmer(LegPain ~ PT_3mo + PT_12mo + PT_3mo12mo + timept + Depscore +
Age + Gender + Preoperativenarcoticuse + Smoker +
Insurance_2grps + NeurogenicClaudication + Revision +
NumberLevels_2grps + ASAGrade_2grps +
BMI + BackPain_bsln + LegPain_bsln +
(1 | StudyID), longdummyfusiondata, REML=FALSE)
s <- summaryM(Gender + Preoperativenarcoticuse + Smoker + Insurance_2grps + NeurogenicClaudication + Revision + NumberLevels_2grps + ASAGrade_2grps + Surgery + Depscore + Age + BMI + BackPain_bsln + LegPain_bsln + ODIPercentage_bsln + EQ5Dscore_bsln ~ PT_3m, data=ptdatawide,
overall=FALSE, test=TRUE)
plot(s, which='categorical', height=5)
plot(s, which='continuous', vars=1 : 4)
plot(s, which='continuous', vars=5 : 7)
html(s, caption='Baseline characteristics by PT within 3 months',
exclude1=FALSE, npct='both', digits=2,
prmsd=TRUE, brmsd=FALSE, msdsize=mu$smaller, long=TRUE)
stargazer(fusiodipd.full,fusieq5dpd.full,fusibackpd.full,fusilegpd.full, type='html',ci=TRUE, covariate.labels=c("PT (6wk-3mo vs. none)", "PT (3mo-12mo vs. none)","PT (6wk-3mo and 3mo-12mo vs. none)","Time (12mo vs. 3mo)","Depression Score","Age","Male","Preop Narcotic Use","Smoker","Insurance: Medicare/Private/VA","Neurogenic Claudication","Revision","Number Levels (3+4)","ASA Grade (3+4)","BMI","Baseline Back Pain","Baseline Leg Pain","Baseline ODI","Baseline EQ5D"), dep.var.labels=c("ODI Percentage <br> Beta (95% CI) </br>", "EQ-5D <br> Beta (95% CI) </br>", "Back Pain <br> Beta (95% CI) </br>", "Leg Pain <br> Beta (95% CI) </br>"), digits=2, initial.zero=FALSE, model.numbers=FALSE, omit="Constant", single.row=TRUE, notes.align="l", dep.var.caption="Fusion")
stargazer(odilam,eq5dlam,backlam,leglam, type='html',ci=TRUE, covariate.labels=c("PT within 3 months","Depression Score","Age","Male","Preop Narcotic Use","Smoker","Insurance: Medicare/Private/VA","NeurogenicClaudication","Revision","Number Levels (3+4)","ASA Grade (3+4)","BMI","Baseline Back Pain","Baseline Leg Pain","Baseline ODI","Baseline EQ5D"), dep.var.labels=c("ODI Percentage <br> Beta (95% CI) </br>", "EQ-5D <br> Beta (95% CI) </br>", "Back Pain <br> Beta (95% CI) </br>", "Leg Pain <br> Beta (95% CI) </br>"), digits=2, initial.zero=FALSE, model.numbers=FALSE, omit="Constant", single.row=TRUE, notes.align="l", dep.var.caption="Laminectomy")
stargazer(lamiodipd.full,lamieq5dpd.full,lamibackpd.full,lamilegpd.full, type='html',ci=TRUE, covariate.labels=c("PT (6wk-3mo vs. none)", "PT (3mo-12mo vs. none)","PT (6wk-3mo and 3mo-12mo vs. none)","Time (12mo vs. 3mo)","Depression Score","Age","Male","Preop Narcotic Use","Smoker","Insurance: Medicare/Private/VA","NeurogenicClaudication","Revision","Number Levels (3+4)","ASA Grade (3+4)","BMI","Baseline Back Pain","Baseline Leg Pain","Baseline ODI","Baseline EQ5D"), dep.var.labels=c("ODI Percentage <br> Beta (95% CI) </br>", "EQ-5D <br> Beta (95% CI) </br>", "Back Pain <br> Beta (95% CI) </br>", "Leg Pain <br> Beta (95% CI) </br>"), digits=2, initial.zero=FALSE, model.numbers=FALSE, omit="Constant", single.row=TRUE, notes.align="l", dep.var.caption="Laminectomy")
require(readr)
require(Hmisc)
require(rms)
require(stargazer)
require(lme4)
require(plotly)
knitrSet(lang='markdown', h=5)
# knitrSet redirects all messages to messages.txt
options(grType='plotly') # for certain graphics functions
mu <- markupSpecs$html   # markupSpecs is in Hmisc
cap  <- mu$cap           # function to output html caption
lcap <- mu$lcap          # for continuation for long caption
# These last 2 functions are used by the putHfig function in Hmisc
stargazer(odifus,eq5dfus,backfus,legfus, type='html',ci=TRUE, covariate.labels=c("PT within 3 months","Depression Score","Age","Male","Preop Narcotic Use","Smoker","Insurance: Medicare/Private/VA","Neurogenic Claudication","Revision","Number Levels (3+4)","ASA Grade (3+4)","BMI","Baseline Back Pain","Baseline Leg Pain","Baseline ODI","Baseline EQ5D"), dep.var.labels=c("ODI Percentage <br> Beta (95% CI) </br>", "EQ-5D <br> Beta (95% CI) </br>", "Back Pain <br> Beta (95% CI) </br>", "Leg Pain <br> Beta (95% CI) </br>"), digits=2, initial.zero=FALSE, model.numbers=FALSE, omit="Constant", single.row=TRUE, notes.align="l", dep.var.caption="Fusion")
stargazer(lamiodipd.full,lamieq5dpd.full,lamibackpd.full,lamilegpd.full, type='html',ci=TRUE, covariate.labels=c("PT (6wk-3mo vs. none)", "PT (3mo-12mo vs. none)","PT (6wk-3mo and 3mo-12mo vs. none)","Time (12mo vs. 3mo)","Depression Score","Age","Male","Preop Narcotic Use","Smoker","Insurance: Medicare/Private/VA","NeurogenicClaudication","Revision","Number Levels (3+4)","ASA Grade (3+4)","BMI","Baseline Back Pain","Baseline Leg Pain","Baseline ODI","Baseline EQ5D"), dep.var.labels=c("ODI Percentage <br> Beta (95% CI) </br>", "EQ-5D <br> Beta (95% CI) </br>", "Back Pain <br> Beta (95% CI) </br>", "Leg Pain <br> Beta (95% CI) </br>"), digits=2, initial.zero=FALSE, model.numbers=FALSE, omit="Constant", single.row=TRUE, notes.align="l", dep.var.caption="Laminectomy")
stargazer(odilam,eq5dlam,backlam,leglam, type='html',ci=TRUE, covariate.labels=c("PT within 3 months","Depression Score","Age","Male","Preop Narcotic Use","Smoker","Insurance: Medicare/Private/VA","NeurogenicClaudication","Revision","Number Levels (3+4)","ASA Grade (3+4)","BMI","Baseline Back Pain","Baseline Leg Pain","Baseline ODI","Baseline EQ5D"), dep.var.labels=c("ODI Percentage <br> Beta (95% CI) </br>", "EQ-5D <br> Beta (95% CI) </br>", "Back Pain <br> Beta (95% CI) </br>", "Leg Pain <br> Beta (95% CI) </br>"), digits=2, initial.zero=FALSE, model.numbers=FALSE, omit="Constant", single.row=TRUE, notes.align="l", dep.var.caption="Laminectomy")
stargazer(fusiodipd.full,fusieq5dpd.full,fusibackpd.full,fusilegpd.full, type='html',ci=TRUE, covariate.labels=c("PT (6wk-3mo vs. none)", "PT (3mo-12mo vs. none)","PT (6wk-3mo and 3mo-12mo vs. none)","Time (12mo vs. 3mo)","Depression Score","Age","Male","Preop Narcotic Use","Smoker","Insurance: Medicare/Private/VA","Neurogenic Claudication","Revision","Number Levels (3+4)","ASA Grade (3+4)","BMI","Baseline Back Pain","Baseline Leg Pain","Baseline ODI","Baseline EQ5D"), dep.var.labels=c("ODI Percentage <br> Beta (95% CI) </br>", "EQ-5D <br> Beta (95% CI) </br>", "Back Pain <br> Beta (95% CI) </br>", "Leg Pain <br> Beta (95% CI) </br>"), digits=2, initial.zero=FALSE, model.numbers=FALSE, omit="Constant", single.row=TRUE, notes.align="l", dep.var.caption="Fusion")
library("rmarkdown")
rmarkdown::render_site()
