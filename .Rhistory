yCauchy <- dcauchy(x)
par(bg = "white")
for (i in 1:20) {
plot(x, yNorm, type = "l", ylab = "Density")
lines(x, dt(x, df = i), col = 2)
lines(x, yCauchy, col = 4)
legend("topright", legend = c("standard normal", paste0("t (df = ",
i, ")"), "Cauchy"), col = c(1, 2, 4), lty = 1)
}
plot(x, yNorm, type = "l", ylab = "Density")
lines(x, yt, col = 2)
plot(x, yNorm, type = "l", ylab = "Density")
lines(x, dt, col = 2)
x <- seq(-6, 6, by = 0.1)
yNorm <- dnorm(x)
yCauchy <- dcauchy(x)
par(bg = "white")
for (i in 1:20) {
plot(x, yNorm, type = "l", ylab = "Density")
lines(x, dt(x, df = i), col = 2)
lines(x, yCauchy, col = 4)
legend("topright", legend = c("standard normal", paste0("t (df = ",
i, ")"), "Cauchy"), col = c(1, 2, 4), lty = 1)
}
dataname2 <- read_csv("C:/Users/jacsp/Dropbox/CPF - Large Longterm Clients/TCU/Howe, Carol/Museum Study - 02.2017/HoweMuseumStudyCSV.031617.v4sb.csv")
library(rms)
library(plotly)
require(EnvStats)
require(gridExtra)
require(sjPlot)
require(sjmisc)
require(readr)
require(lme4)
dataname2 <- read_csv("C:/Users/jacsp/Dropbox/CPF - Large Longterm Clients/TCU/Howe, Carol/Museum Study - 02.2017/HoweMuseumStudyCSV.031617.v4sb.csv")
View(dataname2)
View(dataname2)
dataname2 <- upData(dataname2, labels =
c(ParBMI_CBIS_diff="Parent-BMI CBIS discrepancy score",
Parent_ID="Parent ID",
BMI_rec="Child BMI",
BMI_CBIS="Child BMI CBIS",
Ch_CBIS="Child CBIS",
Age="Child Age",
d_ch_sex="Child sex-male",
d_par_sex="Parent sex-male",
Par_NVS="Parent health literacy",
Educ="Parent education",
Income="Parent income",
d_par_race="Parent race-White",
par_age_OR="Parent age",
d_marital_stat="Marital status-married"))
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
library(rms)
library(plotly)
require(EnvStats)
require(gridExtra)
require(sjPlot)
require(sjmisc)
require(readr)
require(lme4)
dataname2 <- read_csv("C:/Users/jacsp/Dropbox/CPF - Large Longterm Clients/TCU/Howe, Carol/Museum Study - 02.2017/HoweMuseumStudyCSV.031617.v4sb.csv")
dataname2 <- upData(dataname2, labels =
c(ParBMI_CBIS_diff="Parent-BMI CBIS discrepancy score",
Parent_ID="Parent ID",
BMI_rec="Child BMI",
BMI_CBIS="Child BMI CBIS",
Ch_CBIS="Child CBIS",
d_ch_sex="Child sex-male",
d_par_sex="Parent sex-male",
Par_NVS="Parent health literacy",
Educ="Parent education",
Income="Parent income",
d_par_race="Parent race-White",
par_age_OR="Parent age",
d_marital_stat="Marital status-married"))
#######################
dd <- datadist(dataname2) ; options(datadist = "dd")
options(na.action = "na.omit")
options(prType = 'html')
options(grType = 'plotly')
options(contrasts=c("contr.treatment", "contr.treatment"))
knitrSet(lang='markdown', h=5)
mmparent <- lmer(ParBMI_CBIS_diff ~ d_par_sex + Par_NVS + Educ + Income + d_par_race + par_age_OR + d_marital_stat + (1 | Parent_ID), dataname2, REML=FALSE)
mmparentchile <- lmer(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + Educ + Income + d_par_race + rcs(par_age_OR,3) + d_marital_stat + (1 | Parent_ID), dataname2, REML=FALSE)
olsparent <- ols(ParBMI_CBIS_diff ~ d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchild <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchild2 <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + Educ + Income + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchildlinear <- ols(ParBMI_CBIS_diff ~ d_par_sex + Par_NVS + Educ + Income + d_par_race + par_age_OR + d_marital_stat, dataname2)
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
library(rms)
library(plotly)
require(EnvStats)
require(gridExtra)
require(sjPlot)
require(sjmisc)
require(readr)
require(lme4)
dataname2 <- read_csv("C:/Users/jacsp/Dropbox/CPF - Large Longterm Clients/TCU/Howe, Carol/Museum Study - 02.2017/HoweMuseumStudyCSV.031617.v4sb.csv")
dataname2 <- upData(dataname2, labels =
c(ParBMI_CBIS_diff="Parent-BMI CBIS discrepancy score",
Parent_ID="Parent ID",
BMI_rec="Child BMI",
BMI_CBIS="Child BMI CBIS",
Ch_CBIS="Child CBIS",
d_ch_sex="Child sex-male",
d_par_sex="Parent sex-male",
Par_NVS="Parent health literacy",
Educ="Parent education",
Income="Parent income",
d_par_race="Parent race-White",
par_age_OR="Parent age",
d_marital_stat="Marital status-married"))
#######################
dd <- datadist(dataname2) ; options(datadist = "dd")
options(na.action = "na.omit")
options(prType = 'html')
options(grType = 'plotly')
options(contrasts=c("contr.treatment", "contr.treatment"))
knitrSet(lang='markdown', h=5)
mmparent <- lmer(ParBMI_CBIS_diff ~ d_par_sex + Par_NVS + Educ + Income + d_par_race + par_age_OR + d_marital_stat + (1 | Parent_ID), dataname2, REML=FALSE)
mmparentchile <- lmer(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + Educ + Income + d_par_race + rcs(par_age_OR,3) + d_marital_stat + (1 | Parent_ID), dataname2, REML=FALSE)
olsparent <- ols(ParBMI_CBIS_diff ~ d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchild <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchild2 <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + Educ + Income + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchildlinear <- ols(ParBMI_CBIS_diff ~ d_par_sex + Par_NVS + Educ + Income + d_par_race + par_age_OR + d_marital_stat, dataname2)
histParBMI_CBIS_diff <- ggplot(dataname2, aes(ParBMI_CBIS_diff)) + geom_histogram()
histBMI_rec <- ggplot(dataname2, aes(BMI_rec)) + geom_bar()
histPar_NVS <- ggplot(dataname2, aes(Par_NVS)) + geom_bar()
histEduc <- ggplot(dataname2, aes(Educ)) + geom_bar()
histIncome <- ggplot(dataname2, aes(Income)) + geom_bar()
histpar_age_OR <- ggplot(dataname2, aes(par_age_OR)) + geom_bar()
p1 <- ggplotly(histParBMI_CBIS_diff)
p2 <- ggplotly(histBMI_rec)
p3 <- ggplotly(histPar_NVS)
p4 <- ggplotly(histEduc)
p5 <- ggplotly(histIncome)
p6 <- ggplotly(histpar_age_OR)
subplot(p1, p2, p3, shareY = FALSE, titleX = TRUE, titleY = TRUE)
subplot(p4, p5, p6, shareY = FALSE, titleX = TRUE, titleY = TRUE)
ggplot(dataname2, aes(BMI_rec, ParBMI_CBIS_diff)) + geom_point() + geom_smooth(method = "loess") + labs(title = "BMI difference rating by child BMI")
r <- resid(olsparentchild)
par(mfrow=c(2,3))
plot(fitted(olsparentchild), r); abline(h=0) #yhat vs. r
with(dataname2, plot(BMI_rec, r)); abline(h=0)
with(dataname2, plot(Par_NVS, r)); abline(h=0)
with(dataname2, plot(Educ, r)); abline(h=0)
with(dataname2, plot(Income, r)); abline(h=0)
with(dataname2, plot(par_age_OR, r)); abline(h=0)
with(dataname2, plot(ParBMI_CBIS_diff, r)); abline(h=0)
qqnorm(r) #linearity indicates normality
qqline(as.numeric(r))
pgh <- fitted(olsparentchild)
p <- function(fun, row, col) {
f <- substitute(fun); g <- function(F) eval (f)
z <- Ecdf(~ParBMI_CBIS_diff, groups=cut2(pgh, g=6),
fun=function(F) g(1-F),
ylab=as.expression(f), xlim=c(-5, 5), data=dataname2,
label.curve=FALSE)
print(z, split=c(col, row, 2, 2), more=row < 2 | col < 2)
}
p(log(F/(1-F)),    1, 1)
p(qnorm(F),        1, 2)
p(-log(-log(F)),   2, 1)
p(log(-log(1-F)),  2, 2)
f0 <- orm(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, family = probit, data = dataname2)
g0 <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, data = dataname2)
s <- g0$stats['Sigma']
yu <- f0$yunique[-1]
r <- quantile(dataname2$ParBMI_CBIS_diff,na.rm=TRUE, c(.005, .995))
alphas <- coef(f0)[1:num.intercepts(f0)]
d3 <- NULL
d3$alphas <- alphas
d3$myus <- -yu / s
d3 <- data.frame(d3)
ggplot(d3, aes(myus, alphas)) +
geom_line() +
labs(title = "Estimated intercepts from probit model",
x = expression(-y/hat(sigma)),
y = expression(alpha[y]),
subtitle = "Linearity indicates Gaussian residuals.") +
xlim(rev(-r / s))
html(anova(olsparentchild))
plot(anova(olsparentchild))
a <- anova(olsparentchild)
plot(Predict(olsparentchild, ref.zero=FALSE), vnames='names', sepdiscrete='vertical', anova=a)
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
library(rms)
library(plotly)
require(EnvStats)
require(gridExtra)
require(sjPlot)
require(sjmisc)
require(readr)
require(lme4)
dataname2 <- read_csv("C:/Users/jacsp/Dropbox/CPF - Large Longterm Clients/TCU/Howe, Carol/Museum Study - 02.2017/HoweMuseumStudyCSV.031617.v4sb.csv")
dataname2 <- upData(dataname2, labels =
c(ParBMI_CBIS_diff="Parent-BMI CBIS discrepancy score",
Parent_ID="Parent ID",
BMI_rec="Child BMI",
BMI_CBIS="Child BMI CBIS",
Ch_CBIS="Child CBIS",
d_ch_sex="Child sex-male",
d_par_sex="Parent sex-male",
Par_NVS="Parent health literacy",
Educ="Parent education",
Income="Parent income",
d_par_race="Parent race-White",
par_age_OR="Parent age",
d_marital_stat="Marital status-married"))
#######################
dd <- datadist(dataname2) ; options(datadist = "dd")
options(na.action = "na.omit")
options(prType = 'html')
options(grType = 'plotly')
options(contrasts=c("contr.treatment", "contr.treatment"))
knitrSet(lang='markdown', h=5)
mmparent <- lmer(ParBMI_CBIS_diff ~ d_par_sex + Par_NVS + Educ + Income + d_par_race + par_age_OR + d_marital_stat + (1 | Parent_ID), dataname2, REML=FALSE)
mmparentchile <- lmer(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + Educ + Income + d_par_race + rcs(par_age_OR,3) + d_marital_stat + (1 | Parent_ID), dataname2, REML=FALSE)
olsparent <- ols(ParBMI_CBIS_diff ~ d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchild <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchild2 <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + Educ + Income + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchildlinear <- ols(ParBMI_CBIS_diff ~ d_par_sex + Par_NVS + Educ + Income + d_par_race + par_age_OR + d_marital_stat, dataname2)
histParBMI_CBIS_diff <- ggplot(dataname2, aes(ParBMI_CBIS_diff)) + geom_histogram()
histBMI_rec <- ggplot(dataname2, aes(BMI_rec)) + geom_bar()
histPar_NVS <- ggplot(dataname2, aes(Par_NVS)) + geom_bar()
histEduc <- ggplot(dataname2, aes(Educ)) + geom_bar()
histIncome <- ggplot(dataname2, aes(Income)) + geom_bar()
histpar_age_OR <- ggplot(dataname2, aes(par_age_OR)) + geom_bar()
p1 <- ggplotly(histParBMI_CBIS_diff)
p2 <- ggplotly(histBMI_rec)
p3 <- ggplotly(histPar_NVS)
p4 <- ggplotly(histEduc)
p5 <- ggplotly(histIncome)
p6 <- ggplotly(histpar_age_OR)
subplot(p1, p2, p3, shareY = FALSE, titleX = TRUE, titleY = TRUE)
subplot(p4, p5, p6, shareY = FALSE, titleX = TRUE, titleY = TRUE)
ggplot(dataname2, aes(BMI_rec, ParBMI_CBIS_diff)) + geom_point() + geom_smooth(method = "loess") + labs(title = "BMI difference rating by child BMI")
r <- resid(olsparentchild)
par(mfrow=c(2,3))
plot(fitted(olsparentchild), r); abline(h=0) #yhat vs. r
with(dataname2, plot(BMI_rec, r)); abline(h=0)
with(dataname2, plot(Par_NVS, r)); abline(h=0)
with(dataname2, plot(Educ, r)); abline(h=0)
with(dataname2, plot(Income, r)); abline(h=0)
with(dataname2, plot(par_age_OR, r)); abline(h=0)
with(dataname2, plot(ParBMI_CBIS_diff, r)); abline(h=0)
qqnorm(r) #linearity indicates normality
qqline(as.numeric(r))
pgh <- fitted(olsparentchild)
p <- function(fun, row, col) {
f <- substitute(fun); g <- function(F) eval (f)
z <- Ecdf(~ParBMI_CBIS_diff, groups=cut2(pgh, g=6),
fun=function(F) g(1-F),
ylab=as.expression(f), xlim=c(-5, 5), data=dataname2,
label.curve=FALSE)
print(z, split=c(col, row, 2, 2), more=row < 2 | col < 2)
}
p(log(F/(1-F)),    1, 1)
p(qnorm(F),        1, 2)
p(-log(-log(F)),   2, 1)
p(log(-log(1-F)),  2, 2)
f0 <- orm(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, family = probit, data = dataname2)
g0 <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, data = dataname2)
s <- g0$stats['Sigma']
yu <- f0$yunique[-1]
r <- quantile(dataname2$ParBMI_CBIS_diff,na.rm=TRUE, c(.005, .995))
alphas <- coef(f0)[1:num.intercepts(f0)]
d3 <- NULL
d3$alphas <- alphas
d3$myus <- -yu / s
d3 <- data.frame(d3)
ggplot(d3, aes(myus, alphas)) +
geom_line() +
labs(title = "Estimated intercepts from probit model",
x = expression(-y/hat(sigma)),
y = expression(alpha[y]),
subtitle = "Linearity indicates Gaussian residuals.") +
xlim(rev(-r / s))
html(anova(olsparentchild))
plot(anova(olsparentchild))
a <- anova(olsparentchild)
plot(Predict(olsparentchild, ref.zero=FALSE), vnames='names', sepdiscrete='vertical', anova=a)
print(olsparentchild)
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
library(rms)
library(plotly)
require(EnvStats)
require(gridExtra)
require(sjPlot)
require(sjmisc)
require(readr)
require(lme4)
dataname2 <- read_csv("C:/Users/jacsp/Dropbox/CPF - Large Longterm Clients/TCU/Howe, Carol/Museum Study - 02.2017/HoweMuseumStudyCSV.031617.v4sb.csv")
dataname2 <- upData(dataname2, labels =
c(ParBMI_CBIS_diff="Parent-BMI CBIS discrepancy score",
Parent_ID="Parent ID",
BMI_rec="Child BMI",
BMI_CBIS="Child BMI CBIS",
Ch_CBIS="Child CBIS",
d_ch_sex="Child sex-male",
d_par_sex="Parent sex-male",
Par_NVS="Parent health literacy",
Educ="Parent education",
Income="Parent income",
d_par_race="Parent race-White",
par_age_OR="Parent age",
d_marital_stat="Marital status-married"))
#######################
dd <- datadist(dataname2) ; options(datadist = "dd")
options(na.action = "na.omit")
options(prType = 'html')
options(grType = 'plotly')
options(contrasts=c("contr.treatment", "contr.treatment"))
knitrSet(lang='markdown', h=5)
mmparent <- lmer(ParBMI_CBIS_diff ~ d_par_sex + Par_NVS + Educ + Income + d_par_race + par_age_OR + d_marital_stat + (1 | Parent_ID), dataname2, REML=FALSE)
mmparentchile <- lmer(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + Educ + Income + d_par_race + rcs(par_age_OR,3) + d_marital_stat + (1 | Parent_ID), dataname2, REML=FALSE)
olsparent <- ols(ParBMI_CBIS_diff ~ d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchild <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchild2 <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + Educ + Income + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchildlinear <- ols(ParBMI_CBIS_diff ~ d_par_sex + Par_NVS + Educ + Income + d_par_race + par_age_OR + d_marital_stat, dataname2)
histParBMI_CBIS_diff <- ggplot(dataname2, aes(ParBMI_CBIS_diff)) + geom_histogram()
histBMI_rec <- ggplot(dataname2, aes(BMI_rec)) + geom_bar()
histPar_NVS <- ggplot(dataname2, aes(Par_NVS)) + geom_bar()
histEduc <- ggplot(dataname2, aes(Educ)) + geom_bar()
histIncome <- ggplot(dataname2, aes(Income)) + geom_bar()
histpar_age_OR <- ggplot(dataname2, aes(par_age_OR)) + geom_bar()
p1 <- ggplotly(histParBMI_CBIS_diff)
p2 <- ggplotly(histBMI_rec)
p3 <- ggplotly(histPar_NVS)
p4 <- ggplotly(histEduc)
p5 <- ggplotly(histIncome)
p6 <- ggplotly(histpar_age_OR)
subplot(p1, p2, p3, shareY = FALSE, titleX = TRUE, titleY = TRUE)
subplot(p4, p5, p6, shareY = FALSE, titleX = TRUE, titleY = TRUE)
ggplot(dataname2, aes(BMI_rec, ParBMI_CBIS_diff)) + geom_point() + geom_smooth(method = "loess") + labs(title = "BMI difference rating by child BMI")
r <- resid(olsparentchild)
par(mfrow=c(2,3))
plot(fitted(olsparentchild), r); abline(h=0) #yhat vs. r
with(dataname2, plot(BMI_rec, r)); abline(h=0)
with(dataname2, plot(Par_NVS, r)); abline(h=0)
with(dataname2, plot(Educ, r)); abline(h=0)
with(dataname2, plot(Income, r)); abline(h=0)
with(dataname2, plot(par_age_OR, r)); abline(h=0)
with(dataname2, plot(ParBMI_CBIS_diff, r)); abline(h=0)
qqnorm(r) #linearity indicates normality
qqline(as.numeric(r))
pgh <- fitted(olsparentchild)
p <- function(fun, row, col) {
f <- substitute(fun); g <- function(F) eval (f)
z <- Ecdf(~ParBMI_CBIS_diff, groups=cut2(pgh, g=6),
fun=function(F) g(1-F),
ylab=as.expression(f), xlim=c(-5, 5), data=dataname2,
label.curve=FALSE)
print(z, split=c(col, row, 2, 2), more=row < 2 | col < 2)
}
p(log(F/(1-F)),    1, 1)
p(qnorm(F),        1, 2)
p(-log(-log(F)),   2, 1)
p(log(-log(1-F)),  2, 2)
f0 <- orm(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, family = probit, data = dataname2)
g0 <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, data = dataname2)
s <- g0$stats['Sigma']
yu <- f0$yunique[-1]
r <- quantile(dataname2$ParBMI_CBIS_diff,na.rm=TRUE, c(.005, .995))
alphas <- coef(f0)[1:num.intercepts(f0)]
d3 <- NULL
d3$alphas <- alphas
d3$myus <- -yu / s
d3 <- data.frame(d3)
ggplot(d3, aes(myus, alphas)) +
geom_line() +
labs(title = "Estimated intercepts from probit model",
x = expression(-y/hat(sigma)),
y = expression(alpha[y]),
subtitle = "Linearity indicates Gaussian residuals.") +
xlim(rev(-r / s))
html(anova(olsparentchild))
plot(anova(olsparentchild))
a <- anova(olsparentchild)
plot(Predict(olsparentchild, ref.zero=FALSE), vnames='names', sepdiscrete='vertical', anova=a)
print(olsparentchild)
html(summary(olsparentchild))
html(anova(olsparentchild2))
plot(anova(olsparentchild2))
a <- anova(olsparentchild2)
plot(Predict(olsparentchild2, ref.zero=FALSE), vnames='names', sepdiscrete='vertical', anova=a)
print(olsparentchild2)
html(summary(olsparentchild2))
anova(mmparentchile)
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
library(rms)
library(plotly)
require(EnvStats)
require(gridExtra)
require(sjPlot)
require(sjmisc)
require(readr)
require(lme4)
dataname2 <- read_csv("C:/Users/jacsp/Dropbox/CPF - Large Longterm Clients/TCU/Howe, Carol/Museum Study - 02.2017/HoweMuseumStudyCSV.031617.v4sb.csv")
dataname2 <- upData(dataname2, labels =
c(ParBMI_CBIS_diff="Parent-BMI CBIS discrepancy score",
Parent_ID="Parent ID",
BMI_rec="Child BMI",
BMI_CBIS="Child BMI CBIS",
Ch_CBIS="Child CBIS",
d_ch_sex="Child sex-male",
d_par_sex="Parent sex-male",
Par_NVS="Parent health literacy",
Educ="Parent education",
Income="Parent income",
d_par_race="Parent race-White",
par_age_OR="Parent age",
d_marital_stat="Marital status-married"))
#######################
dd <- datadist(dataname2) ; options(datadist = "dd")
options(na.action = "na.omit")
options(prType = 'html')
options(grType = 'plotly')
options(contrasts=c("contr.treatment", "contr.treatment"))
knitrSet(lang='markdown', h=5)
mmparent <- lmer(ParBMI_CBIS_diff ~ d_par_sex + Par_NVS + Educ + Income + d_par_race + par_age_OR + d_marital_stat + (1 | Parent_ID), dataname2, REML=FALSE)
mmparentchile <- lmer(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + Educ + Income + d_par_race + rcs(par_age_OR,3) + d_marital_stat + (1 | Parent_ID), dataname2, REML=FALSE)
olsparent <- ols(ParBMI_CBIS_diff ~ d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchild <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchild2 <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + Educ + Income + d_par_race + rcs(par_age_OR,3) + d_marital_stat, dataname2)
olsparentchildlinear <- ols(ParBMI_CBIS_diff ~ d_par_sex + Par_NVS + Educ + Income + d_par_race + par_age_OR + d_marital_stat, dataname2)
histParBMI_CBIS_diff <- ggplot(dataname2, aes(ParBMI_CBIS_diff)) + geom_histogram()
histBMI_rec <- ggplot(dataname2, aes(BMI_rec)) + geom_bar()
histPar_NVS <- ggplot(dataname2, aes(Par_NVS)) + geom_bar()
histEduc <- ggplot(dataname2, aes(Educ)) + geom_bar()
histIncome <- ggplot(dataname2, aes(Income)) + geom_bar()
histpar_age_OR <- ggplot(dataname2, aes(par_age_OR)) + geom_bar()
p1 <- ggplotly(histParBMI_CBIS_diff)
p2 <- ggplotly(histBMI_rec)
p3 <- ggplotly(histPar_NVS)
p4 <- ggplotly(histEduc)
p5 <- ggplotly(histIncome)
p6 <- ggplotly(histpar_age_OR)
subplot(p1, p2, p3, shareY = FALSE, titleX = TRUE, titleY = TRUE)
subplot(p4, p5, p6, shareY = FALSE, titleX = TRUE, titleY = TRUE)
ggplot(dataname2, aes(BMI_rec, ParBMI_CBIS_diff)) + geom_point() + geom_smooth(method = "loess") + labs(title = "BMI difference rating by child BMI")
r <- resid(olsparentchild)
par(mfrow=c(2,3))
plot(fitted(olsparentchild), r); abline(h=0) #yhat vs. r
with(dataname2, plot(BMI_rec, r)); abline(h=0)
with(dataname2, plot(Par_NVS, r)); abline(h=0)
with(dataname2, plot(Educ, r)); abline(h=0)
with(dataname2, plot(Income, r)); abline(h=0)
with(dataname2, plot(par_age_OR, r)); abline(h=0)
with(dataname2, plot(ParBMI_CBIS_diff, r)); abline(h=0)
qqnorm(r) #linearity indicates normality
qqline(as.numeric(r))
pgh <- fitted(olsparentchild)
p <- function(fun, row, col) {
f <- substitute(fun); g <- function(F) eval (f)
z <- Ecdf(~ParBMI_CBIS_diff, groups=cut2(pgh, g=6),
fun=function(F) g(1-F),
ylab=as.expression(f), xlim=c(-5, 5), data=dataname2,
label.curve=FALSE)
print(z, split=c(col, row, 2, 2), more=row < 2 | col < 2)
}
p(log(F/(1-F)),    1, 1)
p(qnorm(F),        1, 2)
p(-log(-log(F)),   2, 1)
p(log(-log(1-F)),  2, 2)
f0 <- orm(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, family = probit, data = dataname2)
g0 <- ols(ParBMI_CBIS_diff ~ rcs(BMI_rec,3) + d_ch_sex + d_par_sex + rcs(Par_NVS,3) + rcs(Educ,3) + rcs(Income,3) + d_par_race + rcs(par_age_OR,3) + d_marital_stat, data = dataname2)
s <- g0$stats['Sigma']
yu <- f0$yunique[-1]
r <- quantile(dataname2$ParBMI_CBIS_diff,na.rm=TRUE, c(.005, .995))
alphas <- coef(f0)[1:num.intercepts(f0)]
d3 <- NULL
d3$alphas <- alphas
d3$myus <- -yu / s
d3 <- data.frame(d3)
ggplot(d3, aes(myus, alphas)) +
geom_line() +
labs(title = "Estimated intercepts from probit model",
x = expression(-y/hat(sigma)),
y = expression(alpha[y]),
subtitle = "Linearity indicates Gaussian residuals.") +
xlim(rev(-r / s))
html(anova(olsparentchild))
plot(anova(olsparentchild))
a <- anova(olsparentchild)
plot(Predict(olsparentchild, ref.zero=FALSE), vnames='names', sepdiscrete='vertical', anova=a)
print(olsparentchild)
html(summary(olsparentchild))
html(anova(olsparentchild2))
plot(anova(olsparentchild2))
a <- anova(olsparentchild2)
plot(Predict(olsparentchild2, ref.zero=FALSE), vnames='names', sepdiscrete='vertical', anova=a)
print(olsparentchild2)
html(summary(olsparentchild2))
anova(mmparentchile)
print(mmparentchile)
dotplot(ranef(mmparentchile, condVar=TRUE))
setwd("C:/Users/jacsp/Desktop/personal_site")
#render your sweet site.
library("rmarkdown")
rmarkdown::render_site()
setwd("C:/Users/jacsp/Desktop/personal_site")
#render your sweet site.
library("rmarkdown")
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
